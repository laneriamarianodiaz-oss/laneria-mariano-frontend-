<div class="tablero-container">
  <!-- HEADER -->
  <div class="tablero-header">
    <div class="header-content">
      <div class="titulo-seccion">
        <h1 class="titulo">ğŸ“Š Tablero de Reportes</h1>
        <p class="subtitulo">Panel de control y anÃ¡lisis de datos</p>
      </div>

      <div class="header-acciones">
        <button 
          class="btn-toggle-graficos" 
          (click)="toggleGraficos()"
          title="Mostrar/Ocultar grÃ¡ficos"
        >
          <span *ngIf="mostrarGraficos()">ğŸ“Š Ocultar GrÃ¡ficos</span>
          <span *ngIf="!mostrarGraficos()">ğŸ“ˆ Mostrar GrÃ¡ficos</span>
        </button>

        <button class="btn-exportar-excel" (click)="exportarExcel()">
          ğŸ“¥ Excel
        </button>

        <button class="btn-exportar-pdf" (click)="exportarPDF()">
          ğŸ“„ PDF
        </button>

        <button class="btn-refrescar" (click)="refrescar()" [disabled]="cargando()">
          <span *ngIf="!cargando()">ğŸ”„ Refrescar</span>
          <span *ngIf="cargando()" class="spinner-small"></span>
        </button>
      </div>
    </div>

    <!-- Selector de PerÃ­odo -->
    <div class="selector-periodo">
      <button 
        class="periodo-btn"
        [class.activo]="periodoSeleccionado() === 'hoy'"
        (click)="cambiarPeriodo('hoy')"
      >
        ğŸ“… Hoy
      </button>
      <button 
        class="periodo-btn"
        [class.activo]="periodoSeleccionado() === 'semana'"
        (click)="cambiarPeriodo('semana')"
      >
        ğŸ“Š Semana
      </button>
      <button 
        class="periodo-btn"
        [class.activo]="periodoSeleccionado() === 'mes'"
        (click)="cambiarPeriodo('mes')"
      >
        ğŸ“ˆ Mes
      </button>
      <button 
        class="periodo-btn"
        [class.activo]="periodoSeleccionado() === 'ano'"
        (click)="cambiarPeriodo('ano')"
      >
        ğŸ“Š AÃ±o
      </button>
    </div>

    <div class="fecha-actualizacion" *ngIf="fechaActualizacion()">
      <span>â° Ãšltima actualizaciÃ³n: {{ fechaActualizacion() }}</span>
    </div>
  </div>

  <!-- INDICADOR DE CARGA -->
  <div *ngIf="cargando()" class="cargando-container">
    <div class="spinner"></div>
    <p>Cargando datos del tablero...</p>
  </div>

  <!-- CONTENIDO PRINCIPAL -->
  <div *ngIf="!cargando() && estadisticas()" class="tablero-content">
    
    <!-- MÃ‰TRICAS PRINCIPALES -->
    <div class="metricas-principales">
      <div class="tarjeta-metrica tarjeta-ventas">
        <div class="metrica-header">
          <span class="metrica-icono">ğŸ’°</span>
          <span class="metrica-badge">{{ obtenerEtiquetaPeriodo() }}</span>
        </div>
        <p class="metrica-label">Total de Ventas</p>
        <p class="metrica-valor">{{ formatearMoneda(obtenerValorPeriodo()) }}</p>
        <div class="metrica-footer">
          <span class="metrica-detalle">Ticket promedio: {{ formatearMoneda(estadisticas()!.ticket_promedio) }}</span>
        </div>
      </div>

      <div class="tarjeta-metrica tarjeta-clientes" (click)="verClientes()">
        <div class="metrica-header">
          <span class="metrica-icono">ğŸ‘¥</span>
          <span class="metrica-badge">{{ estadisticas()!.total_clientes }}</span>
        </div>
        <p class="metrica-label">Total Clientes</p>
        <p class="metrica-descripcion">Clientes registrados en el sistema</p>
        <button class="btn-ver-detalle">Ver detalles â†’</button>
      </div>

      <div class="tarjeta-metrica tarjeta-productos" (click)="verProductos()">
        <div class="metrica-header">
          <span class="metrica-icono">ğŸ§¶</span>
          <span class="metrica-badge">{{ estadisticas()!.total_productos }}</span>
        </div>
        <p class="metrica-label">Total Productos</p>
        <p class="metrica-descripcion">Productos en catÃ¡logo</p>
        <button class="btn-ver-detalle">Ver inventario â†’</button>
      </div>

      <div 
        class="tarjeta-metrica tarjeta-alerta" 
        (click)="verProductosStockBajo()"
        *ngIf="estadisticas()!.productos_stock_bajo > 0"
      >
        <div class="metrica-header">
          <span class="metrica-icono">âš ï¸</span>
          <span class="metrica-badge badge-alerta">{{ estadisticas()!.productos_stock_bajo }}</span>
        </div>
        <p class="metrica-label">Stock Bajo</p>
        <p class="metrica-descripcion">Productos que necesitan reposiciÃ³n</p>
        <button class="btn-ver-detalle btn-alerta">Revisar ahora â†’</button>
      </div>

      <div 
        class="tarjeta-metrica tarjeta-pendiente" 
        (click)="verPedidosPendientes()"
        *ngIf="estadisticas()!.pedidos_pendientes > 0"
      >
        <div class="metrica-header">
          <span class="metrica-icono">â³</span>
          <span class="metrica-badge badge-pendiente">{{ estadisticas()!.pedidos_pendientes }}</span>
        </div>
        <p class="metrica-label">Pedidos Pendientes</p>
        <p class="metrica-descripcion">Pedidos por procesar</p>
        <button class="btn-ver-detalle btn-pendiente">Gestionar â†’</button>
      </div>
    </div>

    <!-- GRÃFICOS Y ANÃLISIS -->
    <div class="seccion-graficos" *ngIf="mostrarGraficos()">
      <h2 class="seccion-titulo">ğŸ“Š AnÃ¡lisis Visual</h2>

      <!-- GrÃ¡fico de Ventas -->
      <div class="grafico-card">
        <app-grafico-ventas></app-grafico-ventas>
      </div>

      <!-- Grid de GrÃ¡ficos -->
      <div class="grid-graficos">
        <!-- Productos MÃ¡s Vendidos -->
        <div class="grafico-card">
          <app-productos-vendidos></app-productos-vendidos>
        </div>

        <!-- MÃ©todos de Pago -->
        <div class="grafico-card">
          <app-grafico-metodos-pago></app-grafico-metodos-pago>
        </div>
      </div>
    </div>

  </div>

  <!-- SIN DATOS -->
  <div *ngIf="!cargando() && !estadisticas()" class="sin-datos">
    <div class="sin-datos-icono">ğŸ“Š</div>
    <h3>No hay datos disponibles</h3>
    <p>No se pudieron cargar las estadÃ­sticas del tablero.</p>
    <button class="btn-reintentar" (click)="refrescar()">
      ğŸ”„ Reintentar
    </button>
  </div>
</div>